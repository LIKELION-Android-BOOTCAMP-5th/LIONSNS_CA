# 프로젝트 파일 구조

##  전체 프로젝트 구조

```
community_app/
├── android/                    # Android 플랫폼 설정
│   ├── app/
│   │   ├── build.gradle.kts   # Android 앱 빌드 설정
│   │   └── src/
│   │       ├── main/
│   │       │   ├── AndroidManifest.xml
│   │       │   ├── kotlin/...  # Kotlin 소스 파일
│   │       │   └── res/        # 리소스 파일
│   │       ├── debug/
│   │       └── profile/
│   ├── build.gradle.kts        # 프로젝트 빌드 설정
│   └── gradle/
│
├── ios/                        # iOS 플랫폼 설정
│   ├── Runner/
│   │   ├── AppDelegate.swift   # iOS 앱 진입점
│   │   ├── Info.plist
│   │   ├── Assets.xcassets/    # 아이콘 및 이미지
│   │   └── Base.lproj/         # 스토리보드 파일
│   └── Podfile                 # CocoaPods 의존성
│
├── web/                        # Web 플랫폼 설정
│   ├── index.html              # 웹 앱 진입점
│   ├── manifest.json
│   └── icons/                  # 웹 아이콘
│
├── macos/                      # macOS 플랫폼 설정
│   └── Runner/
│
├── linux/                      # Linux 플랫폼 설정
│   └── runner/
│
├── windows/                    # Windows 플랫폼 설정
│   └── runner/
│
├── lib/                        # Dart 소스 코드 (핵심)
│   ├── main.dart               # 앱 진입점
│   ├── config/                 # 앱 설정
│   │   └── router.dart         # GoRouter 라우팅 설정
│   ├── core/                   # 공통 코드
│   │   ├── services/           # 서비스 레이어 (Supabase, Firebase 등)
│   │   ├── constants/          # 상수 정의
│   │   ├── utils/              # 유틸리티
│   │   └── widgets/            # 공통 위젯
│   ├── l10n/                   # 다국어 리소스
│   │   ├── app_ko.arb          # 한국어 문자열
│   │   ├── app_en.arb          # 영어 문자열
│   │   └── app_localizations*.dart  # (자동 생성) 다국어 클래스
│   ├── presentation/           # 앱 레벨 UI 컴포넌트
│   │   └── pages/             # 전역 페이지
│   │       └── main_navigation_screen.dart  # 메인 네비게이션 화면
│   └── features/               # 기능별 모듈 (Feature-based)
│       ├── auth/               # 인증 기능
│       ├── feed/               # 피드 기능
│       └── search/             # 검색 기능
│
├── test/                       # 테스트 코드
│   └── widget_test.dart
│
├── supabase/                   # Supabase 설정
│   └── functions/              # Edge Functions
│       ├── post-stats/
│       └── send-push-notification/
│
├── docs/                       # 문서
│   ├── README.md              # 문서 목차 및 가이드
│   ├── 개발/                  # 개발 관련 문서
│   │   ├── 아키텍처.md        # 아키텍처 설명
│   │   ├── 프로젝트_파일_구조.md  # (이 파일)
│   │   └── 데이터베이스/      # 데이터베이스 관련
│   │       ├── schema.sql     # 데이터베이스 스키마
│   │       └── 초기_설정_가이드.md
│   └── 설정/                  # 설정 관련 문서
│       ├── Supabase_초기_설정_가이드.md
│       ├── 소셜_로그인_완전_가이드.md
│       ├── 푸시_알림_완전_가이드.md
│       ├── 다국어_가이드.md
│       ├── 위젯_구현_가이드.md
│       ├── 앱_환경정보_관리_가이드.md
│       └── Storage/           # Storage 관련
│           ├── storage_policies.sql
│           ├── storage_policies_profile.sql
│           └── 초기_설정_가이드.md
│
├── pubspec.yaml                # Flutter 의존성 관리
├── pubspec.lock                # 의존성 버전 고정
├── analysis_options.yaml       # Dart 분석 설정
└── README.md                   # 프로젝트 설명
```

---

##  lib/ 디렉토리 상세 구조

### `lib/main.dart`
- **역할**: Flutter 앱의 진입점
- **주요 기능**:
  - Firebase 초기화
  - Supabase 초기화
  - Riverpod ProviderScope 설정
  - GoRouter 설정

### `lib/config/` - 앱 설정
```
config/
└── router.dart              # GoRouter 라우팅 설정
                             # - 라우트 경로 정의 (AppRoutes)
                             # - 인증 상태에 따른 리다이렉트
                             # - 라우트 정의 (Login, Home, Profile, Post 등)
```

### `lib/core/` - 공통 코드

#### `core/services/` - 서비스 레이어
```
services/
├── external/                    # 외부 서비스
│   ├── supabase_service.dart    # Supabase 클라이언트 초기화 및 관리
│   └── firebase_service.dart    # Firebase 서비스 (푸시 알림용)
└── internal/                    # 내부 서비스
    ├── auth_provider_service.dart    # 소셜 로그인 제공자 관리
    ├── storage_service_interface.dart # Storage 서비스 인터페이스
    ├── storage_service_provider.dart  # Storage 서비스 Provider
    ├── supabase_storage_service.dart  # Supabase Storage 구현
    ├── firebase_storage_service.dart  # Firebase Storage 구현 (대체용)
    ├── widget_data_service.dart       # 위젯 데이터 집계 및 저장
    ├── widget_update_service.dart     # 위젯 업데이트 (Method Channel)
    ├── widget_update_service_provider.dart # 위젯 업데이트 서비스 Provider
    └── deep_link_service.dart         # Deep Link 처리 (위젯→앱)
```

**역할**:
- 외부 서비스와의 통신 담당
- 인증, 데이터베이스, Storage, 푸시 알림 등
- 위젯 데이터 관리 및 업데이트
- Deep Link 처리

#### `core/constants/` - 상수 정의
```
constants/
└── widget_data_keys.dart        # 위젯 데이터 키 상수 (SharedPreferences)
```

#### `core/utils/` - 유틸리티
```
utils/
└── result.dart                  # Result 패턴 구현
                                 # - Success<T>
                                 # - Failure<T>
                                 # - Pending<T>
                                 # - when() 확장 메서드
```

#### `core/widgets/` - 공통 위젯
```
widgets/
└── (공통 위젯이 있으면 여기에 추가)
```

---

### `lib/presentation/` - 앱 레벨 UI 컴포넌트

```
presentation/
└── pages/
    └── main_navigation_screen.dart  # 메인 네비게이션 화면
                                    # - 하단 탭 네비게이션 (홈, 검색, 좋아요, 프로필)
                                    # - 앱 전체 네비게이션 구조 관리
```

**역할**:
- 앱 전역 UI 컴포넌트 관리
- 비즈니스 로직이 없는 순수 UI 구성 요소
- `features/` 디렉토리는 실제 비즈니스 기능만 포함

---

### `lib/features/` - 기능별 모듈

각 기능은 **Feature-based Architecture + MVVM** 패턴을 따르며, 다음 구조를 가집니다:

#### 표준 구조 (목표)

```
features/
└── {feature_name}/
    ├── domain/                  # 도메인 모델 (피처별, 선택적)
    │   └── {feature}_model.dart # 여러 피처가 공용으로 쓰면 core/models에 유지
    ├── data/                    # 데이터 레이어
    │   └── {feature}_datasource.dart  # 외부 데이터 소스 접근 (Supabase, API 등)
    └── presentation/            # 프레젠테이션 레이어 (UI + ViewModel)
        ├── providers.dart       # 모든 Provider 정의 (DI)
        ├── viewmodels/          # ViewModel들
        │   ├── {feature}_list_viewmodel.dart
        │   ├── {feature}_detail_viewmodel.dart
        │   └── {feature}_form_viewmodel.dart
        └── screens/             # 화면들
            ├── {feature}_list_screen.dart
            ├── {feature}_detail_screen.dart
            └── {feature}_form_screen.dart
```

#### `features/auth/` - 인증 기능

```
auth/
├── domain/                      # 도메인 레이어
│   ├── entities/                # 엔티티 (도메인 모델)
│   │   └── user.dart            # User 엔티티 (순수 객체)
│   ├── factories/               # Factory 인터페이스
│   │   └── repository_factory.dart
│   ├── providers/               # Provider (Domain 레이어)
│   │   ├── providers.dart       # 통합 export
│   │   ├── repository_providers.dart  # Factory Provider re-export
│   │   └── usecase_providers.dart     # UseCase Provider
│   ├── repositories/            # Repository 인터페이스
│   │   ├── auth_repository.dart
│   │   ├── profile_repository.dart
│   │   └── follow_repository.dart
│   └── usecases/                # Use Case
│       ├── sign_in_usecase.dart
│       ├── logout_usecase.dart
│       ├── get_current_user_usecase.dart
│       ├── watch_auth_state_usecase.dart
│       ├── get_profile_usecase.dart
│       ├── update_profile_usecase.dart
│       ├── get_follow_list_usecase.dart
│       ├── get_follow_status_usecase.dart
│       └── toggle_follow_usecase.dart
│
├── data/                        # 데이터 레이어
│   ├── datasources/             # 데이터 소스
│   │   ├── supabase_auth_datasource.dart
│   │   ├── supabase_profile_datasource.dart
│   │   └── supabase_follow_datasource.dart
│   ├── datasource_providers.dart # Datasource Provider
│   ├── dtos/                    # Data Transfer Object
│   │   └── user_dto.dart        # User DTO
│   ├── factories/               # Factory 구현체
│   │   └── supabase_repository_factory.dart
│   ├── providers/               # Factory Provider (Data 레이어)
│   │   └── factory_providers.dart
│   └── repositories/            # Repository 구현
│       ├── supabase_auth_repository.dart
│       ├── firebase_auth_repository.dart  # (대체용)
│       ├── supabase_profile_repository.dart
│       └── supabase_follow_repository.dart
│
└── presentation/                # 프레젠테이션 레이어
    ├── providers/               # Provider 정의
    │   ├── providers.dart       # 통합 export (Domain Provider만 export)
    │   └── viewmodel_providers.dart
    ├── viewmodels/              # ViewModel (Use Cases만 사용)
    │   ├── auth_viewmodel.dart
    │   ├── profile_edit_viewmodel.dart
    │   └── follow_viewmodel.dart
    ├── pages/                   # 화면
    │   ├── auth_screen.dart
    │   ├── profile_screen.dart
    │   └── profile_edit_screen.dart
    └── widgets/                 # 위젯
        └── user_profile_options_sheet.dart
```

#### `features/feed/` - 피드 기능

```
feed/
├── domain/                      # 도메인 레이어
│   ├── entities/                # 엔티티 (도메인 모델)
│   │   ├── post.dart            # Post 엔티티
│   │   └── comment.dart         # Comment 엔티티
│   ├── factories/               # Factory 인터페이스
│   │   └── repository_factory.dart  # Repository Factory 인터페이스
│   ├── providers/               # Provider (Domain 레이어)
│   │   ├── providers.dart       # 통합 export
│   │   ├── repository_providers.dart  # Factory Provider re-export
│   │   └── usecase_providers.dart     # UseCase Provider
│   ├── repositories/            # Repository 인터페이스
│   │   ├── post_repository.dart      # 게시글 Repository 인터페이스
│   │   ├── comment_repository.dart   # 댓글 Repository 인터페이스
│   │   └── like_repository.dart      # 좋아요 Repository 인터페이스
│   └── usecases/                # Use Case
│       ├── get_posts_usecase.dart         # 게시글 목록 조회 Use Case
│       ├── get_post_by_id_usecase.dart    # 게시글 상세 조회 Use Case
│       ├── create_post_usecase.dart       # 게시글 작성 Use Case
│       ├── update_post_usecase.dart       # 게시글 수정 Use Case
│       ├── delete_post_usecase.dart      # 게시글 삭제 Use Case
│       ├── get_comments_usecase.dart      # 댓글 목록 조회 Use Case
│       ├── create_comment_usecase.dart    # 댓글 작성 Use Case
│       └── toggle_like_usecase.dart      # 좋아요 토글 Use Case
│
├── data/                        # 데이터 레이어
│   ├── datasources/             # 데이터 소스 구현체
│   │   ├── supabase_post_datasource.dart          # 게시글 데이터 소스
│   │   │                                 # - 게시글 CRUD (JOIN 쿼리)
│   │   │                                 # - 이미지 업로드 (Supabase Storage)
│   │   │                                 # - 작성자 프로필 정보 JOIN
│   │   ├── supabase_comment_datasource.dart       # 댓글 데이터 소스
│   │   │                                 # - 댓글 CRUD (JOIN 쿼리)
│   │   │                                 # - 작성자 프로필 정보 JOIN
│   │   └── supabase_like_datasource.dart          # 좋아요 데이터 소스
│   │                                     # - 좋아요 추가/취소
│   │                                     # - 좋아요 개수 조회
│   ├── dtos/                    # Data Transfer Object
│   │   ├── post_dto.dart        # Post DTO
│   │   │   └── post_dto.g.dart  # (자동 생성) JSON 직렬화
│   │   └── comment_dto.dart     # Comment DTO
│   │       └── comment_dto.g.dart  # (자동 생성) JSON 직렬화
│   ├── datasource_providers.dart # Datasource Provider (Data 레이어)
│   ├── factories/               # Factory 구현체
│   │   └── supabase_repository_factory.dart  # Repository Factory 구현
│   ├── providers/               # Factory Provider (Data 레이어)
│   │   └── factory_providers.dart
│   └── repositories/            # Repository 구현
│       ├── supabase_post_repository.dart      # Supabase 게시글 구현
│       ├── supabase_comment_repository.dart   # Supabase 댓글 구현
│       └── supabase_like_repository.dart      # Supabase 좋아요 구현
│
└── presentation/                # 프레젠테이션 레이어
    ├── providers/               # Provider 정의
    │   ├── providers.dart       # 통합 export (사용 편의성)
    │   ├── usecase_providers.dart   # UseCase Provider (Domain UseCase만 참조)
    │   └── viewmodel_providers.dart # ViewModel Provider (UseCase만 참조)
    ├── viewmodels/              # ViewModel
    │   ├── post_list_viewmodel.dart      # 게시글 목록 ViewModel
    │   ├── post_detail_viewmodel.dart    # 게시글 상세 ViewModel
    │   ├── post_form_viewmodel.dart      # 게시글 작성/수정 ViewModel
    │   └── liked_posts_viewmodel.dart    # 좋아요한 게시글 ViewModel
    ├── pages/                   # 화면
    │   ├── post_list_screen.dart         # 게시글 목록 화면
    │   ├── post_detail_screen.dart       # 게시글 상세 화면
    │   ├── post_form_screen.dart         # 게시글 작성/수정 화면
    │   ├── liked_posts_screen.dart       # 좋아요한 게시글 화면
    │   └── search_screen.dart            # 검색 화면
    └── widgets/                 # 위젯
        └── post_card.dart               # 게시글 카드 위젯
```

#### `features/search/` - 검색 기능

```
search/
├── domain/                      # 도메인 레이어
│   ├── entities/                # 엔티티 (도메인 모델)
│   │   └── search_results.dart  # 검색 결과 엔티티
│   ├── factories/               # Factory 인터페이스
│   │   └── repository_factory.dart  # Repository Factory 인터페이스
│   ├── providers/               # Provider (Domain 레이어)
│   │   ├── providers.dart       # 통합 export
│   │   ├── repository_providers.dart  # Factory Provider re-export
│   │   └── usecase_providers.dart     # UseCase Provider
│   ├── repositories/            # Repository 인터페이스
│   │   └── search_repository.dart    # 검색 Repository 인터페이스
│   └── usecases/                # Use Case
│       └── search_usecase.dart       # 검색 Use Case
├── data/                        # 데이터 레이어
│   ├── datasources/             # 데이터 소스 구현체
│   │   └── supabase_search_datasource.dart    # 검색 데이터 소스
│   │                               # - 사용자 검색
│   │                               # - 댓글 검색
│   │                               # - 포스트 검색
│   ├── datasource_providers.dart # Datasource Provider (Data 레이어)
│   ├── factories/               # Factory 구현체
│   │   └── supabase_repository_factory.dart  # Repository Factory 구현
│   ├── providers/               # Factory Provider (Data 레이어)
│   │   └── factory_providers.dart
│   └── repositories/            # Repository 구현
│       └── supabase_search_repository.dart     # Supabase 검색 구현
│
└── presentation/
    ├── providers/               # Provider 정의
    │   ├── providers.dart       # 통합 export (사용 편의성)
    │   ├── usecase_providers.dart   # UseCase Provider (Domain UseCase만 참조)
    │   └── viewmodel_providers.dart # ViewModel Provider (UseCase만 참조)
    ├── viewmodels/
    │   └── search_viewmodel.dart  # 검색 ViewModel (Use Cases 사용)
    └── widgets/
        ├── user_search_item.dart    # 사용자 검색 결과 위젯
        └── comment_search_item.dart # 댓글 검색 결과 위젯
```

#### Repository 패턴

> **참고**: 현재 프로젝트는 Repository 패턴을 사용하여 데이터 레이어를 추상화합니다.

**레이어 구조**:
1. **Domain Layer** (`domain/repositories/`): Repository 인터페이스 정의
2. **Data Layer** (`data/`): Datasource와 Repository 구현
3. **Presentation Layer** (`presentation/providers/`): Provider를 통한 DI

**장점**:
- 백엔드 교체 시 Repository 구현만 변경하면 됨 (인터페이스 유지)
- 테스트 시 Mock Repository 사용 가능
- Datasource와 Repository 분리로 책임 명확화

---

##  Supabase 구조

### `docs/개발/데이터베이스/` - 데이터베이스 관련
```
데이터베이스/
├── schema.sql                   # 통합 데이터베이스 스키마 (재생성용)
│                               # - user_profiles (사용자 프로필)
│                               # - device_tokens (푸시 알림 토큰)
│                               # - posts (게시글, user_id는 user_profiles.id 참조)
│                               # - post_likes (좋아요)
│                               # - comments (댓글, user_id는 user_profiles.id 참조)
│                               # - follows (팔로우, follower_id/following_id는 user_profiles.id 참조)
│                               # - RLS 정책 및 트리거
│                               # - 인덱스
└── 초기_설정_가이드.md          # 데이터베이스 초기 설정 가이드
```

### `docs/설정/Storage/` - Storage 정책
```
Storage/
├── storage_policies.sql         # post-images 버킷 RLS 정책
├── storage_policies_profile.sql # profile-images 버킷 RLS 정책
└── 초기_설정_가이드.md          # Storage 초기 설정 가이드
```

---

##  플랫폼별 설정 파일

### Android (`android/`)
- `app/build.gradle.kts`: 앱 빌드 설정, 의존성
- `app/src/main/AndroidManifest.xml`: 앱 권한 및 설정
- `app/src/main/kotlin/`: Kotlin 네이티브 코드
  - `MainActivity.kt`: Method Channel 처리, Deep Link 처리
  - `widget/`: 홈 화면 위젯 관련
    - `HomeWidget.kt`: Jetpack Compose Glance 위젯 UI
    - `HomeWidgetReceiver.kt`: 위젯 리시버
    - `WidgetDataKeys.kt`: 위젯 데이터 키 상수 정의
- `app/src/main/res/`: 리소스 파일
  - `xml/home_widget_info.xml`: 위젯 설정
  - `layout/home_widget_preview.xml`: 위젯 프리뷰 레이아웃
  - `drawable/widget_preview.xml`: 위젯 프리뷰 이미지
  - `values/colors.xml`: 위젯 색상 정의

### iOS (`ios/`)
- `Runner/AppDelegate.swift`: iOS 앱 진입점, Method Channel 처리
- `Runner/Info.plist`: 앱 설정 및 권한
- `HomeWidget/`: WidgetKit Extension
  - `HomeWidget.swift`: 위젯 UI (SwiftUI)
- `Podfile`: CocoaPods 의존성

### Web (`web/`)
- `index.html`: 웹 앱 진입점
- `manifest.json`: PWA 설정

---

##  아키텍처 패턴

### 1. **Feature-based Architecture**
- 기능별로 모듈 분리 (`features/{feature}/`)
- 각 기능은 독립적으로 관리 가능
- 기능 간 의존성 최소화

### 2. **MVVM (Model-View-ViewModel)**
- **Model**: 
  - `features/{feature}/domain/` - 도메인 모델
- **View**: `features/{feature}/presentation/pages/` (UI 화면)
- **ViewModel**: `features/{feature}/presentation/viewmodels/` (상태 관리)

### 3. **Clean Architecture 레이어 분리**
```
Presentation Layer (presentation/)
  ├── pages/            # UI (View)
  ├── viewmodels/       # ViewModel (Use Case 사용)
  └── providers/        # Dependency Injection

Domain Layer (domain/)
  ├── entities/         # Domain Entity (순수 객체)
  ├── factories/        # Factory 인터페이스
  ├── providers/        # Provider (Domain 레이어)
  ├── repositories/     # Repository 인터페이스
  └── usecases/         # Use Case (비즈니스 로직)

Data Layer (data/)
  ├── datasources/      # 외부 데이터 소스 접근
  ├── dtos/             # Data Transfer Object
  ├── factories/        # Factory 구현체
  ├── providers/        # Factory Provider (Data 레이어)
  └── repositories/     # Repository 구현
```

### 4. **Factory 패턴 (의존성 역전 강화)**
- Domain 레이어에 Factory 인터페이스 정의
- Data 레이어에서 Factory 구현체 제공
- Domain 레이어가 Data 레이어를 직접 import하지 않음
- 완벽한 의존성 역전 원칙(DIP) 준수

### 5. **Dependency Injection (Riverpod)**
- 레이어별로 Provider 분리 관리
- Domain 레이어: Factory Provider re-export, UseCase Provider
- Data 레이어: Datasource Provider, Factory Provider
- Presentation 레이어: ViewModel Provider
- 통합 export 파일로 사용 편의성 제공

### 6. **Repository/Datasource Pattern**
- `features/{feature}/data/datasources/` - 외부 데이터 소스 접근
- `features/{feature}/domain/repositories/` - Repository 인터페이스 정의
- `features/{feature}/data/repositories/` - Repository 구현
- Use Case에서 Repository 인터페이스 사용 (Factory 패턴을 통해 생성)

### 7. **Use Case Pattern**
- `features/{feature}/domain/usecases/`
- 비즈니스 로직을 Use Case로 캡슐화
- Factory 패턴을 통해 Repository 생성
- ViewModel은 Use Case만 사용 (Repository/Datasource 직접 사용 불가)

### 8. **DTO (Data Transfer Object) Pattern**
- `features/{feature}/data/dtos/`
- 외부 데이터 소스의 데이터 구조를 Domain Entity와 분리
- DTO → Domain Entity 변환 로직 포함

### 9. **Result Pattern**
- `core/utils/result.dart`
- 성공/실패 상태를 명시적으로 표현
- 에러 처리 일관성 유지

---

##  주요 의존성 (pubspec.yaml)

### 상태 관리
- `flutter_riverpod`: 상태 관리 및 DI

### 라우팅
- `go_router`: 선언적 라우팅

### 백엔드
- `supabase_flutter`: Supabase 클라이언트

### 인증
- `google_sign_in`: Google 로그인
- `sign_in_with_apple`: Apple 로그인
- `kakao_flutter_sdk`: Kakao 로그인

### 푸시 알림
- `firebase_core`: Firebase 초기화
- `firebase_messaging`: FCM 푸시 알림
- `flutter_local_notifications`: 로컬 알림

### 유틸리티
- `json_annotation` / `json_serializable`: JSON 직렬화
- `flutter_dotenv`: 환경 변수 관리
- `url_launcher`: URL 열기
- `shared_preferences`: 로컬 저장소 (위젯 데이터 저장)
- `workmanager`: 백그라운드 작업 (위젯 업데이트)

---

##  데이터 흐름

### Clean Architecture 데이터 흐름

```
Screen (presentation/pages/)
    ↓
ViewModel (presentation/viewmodels/)
    ↓
Use Case (domain/usecases/)
    ↓
Repository Interface (domain/repositories/)
    ↓
Repository Implementation (data/repositories/)
    ↓
Datasource (data/datasources/)
    ↓
Service (core/services/) - Supabase, Firebase 등
    ↓
외부 API/서비스
```

### 예시: 게시글 작성

1. **Screen**: `PostFormScreen`에서 사용자 입력 받음
2. **ViewModel**: `PostFormViewModel.createPost()` 호출
   - `presentation/viewmodels/post_form_viewmodel.dart`
3. **Use Case**: `CreatePostUseCase.execute()` 호출
   - `domain/usecases/create_post_usecase.dart`
4. **Repository**: `PostRepository.createPost()` 호출
   - `domain/repositories/post_repository.dart` (인터페이스)
   - `data/repositories/supabase_post_repository.dart` (구현)
5. **Datasource**: `PostDatasource.createPost()` 호출
   - `data/datasources/post_datasource.dart`
6. **Service**: `SupabaseService`를 통해 데이터베이스에 저장
   - `core/services/supabase_service.dart`
7. **결과**: `Result<Post>` 반환 → Use Case → ViewModel → Screen에 성공/실패 표시

### Provider 구조

```dart
// domain/providers/usecase_providers.dart - UseCase Provider (Domain 레이어)
final createPostUseCaseProvider = Provider<CreatePostUseCase>((ref) {
  final factory = ref.watch(repositoryFactoryProvider);
  final repository = factory.createPostRepository();
  return CreatePostUseCase(repository);
});

// presentation/providers/viewmodel_providers.dart - ViewModel Provider
final postFormViewModelProvider = StateNotifierProvider<PostFormViewModel, PostFormState>((ref) {
  final createPostUseCase = ref.watch(createPostUseCaseProvider);
  final updatePostUseCase = ref.watch(updatePostUseCaseProvider);
  final getPostByIdUseCase = ref.watch(getPostByIdUseCaseProvider);
  final getCurrentUserUseCase = ref.watch(getCurrentUserUseCaseProvider);
  return PostFormViewModel(
    createPostUseCase: createPostUseCase,
    updatePostUseCase: updatePostUseCase,
    getPostByIdUseCase: getPostByIdUseCase,
    getCurrentUserUseCase: getCurrentUserUseCase,
  );
});

// presentation/pages/post_form_screen.dart
final viewModel = ref.watch(postFormViewModelProvider);
```

---

##  파일 네이밍 규칙

### Dart 파일
- **snake_case** 사용
- 예: `post_detail_screen.dart`, `auth_repository.dart`

### 클래스
- **PascalCase** 사용
- 예: `PostDetailScreen`, `AuthRepository`

### 변수/함수
- **camelCase** 사용
- 예: `postId`, `getUserProfile()`

### 상수
- **camelCase** 또는 **SCREAMING_SNAKE_CASE**
- 예: `AppRoutes.home` 또는 `MAX_RETRY_COUNT`

---

##  주요 파일 설명

### `lib/main.dart`
- 앱 진입점
- Firebase, Supabase 초기화
- ProviderScope 및 GoRouter 설정

### `lib/config/router.dart`
- 라우트 경로 정의
- 인증 상태에 따른 리다이렉트
- 라우트 매핑

### `lib/core/services/supabase_service.dart`
- Supabase 클라이언트 싱글톤
- 프로젝트 URL 및 Anon Key 관리

### `lib/core/utils/result.dart`
- Result 패턴 구현
- 비동기 작업의 성공/실패 상태 표현

### `lib/l10n/`
- 다국어 리소스 파일 (ARB)
- `flutter gen-l10n`으로 자동 생성되는 `AppLocalizations` 클래스

---

##  추가 문서

### 개발 관련
- [README.md](../README.md) - 문서 목차 및 가이드
- [아키텍처.md](./아키텍처.md) - 아키텍처 설명
- [데이터베이스/초기_설정_가이드.md](./데이터베이스/초기_설정_가이드.md) - 데이터베이스 초기 설정

### 설정 관련
- [Supabase_초기_설정_가이드.md](../설정/Supabase_초기_설정_가이드.md) - Supabase 초기 설정
- [소셜_로그인_완전_가이드.md](../설정/소셜_로그인_완전_가이드.md) - 소셜 로그인 구현
- [푸시_알림_완전_가이드.md](../설정/푸시_알림_완전_가이드.md) - 푸시 알림 구현
- [다국어_가이드.md](../설정/다국어_가이드.md) - 다국어 처리 가이드
- [위젯_구현_가이드.md](../설정/위젯_구현_가이드.md) - 홈 화면 위젯 구현
- [앱_환경정보_관리_가이드.md](../설정/앱_환경정보_관리_가이드.md) - 환경 정보 관리
- [Storage/초기_설정_가이드.md](../설정/Storage/초기_설정_가이드.md) - Storage 초기 설정

---

##  개발 워크플로우

### 1. 새 기능 추가 (Clean Architecture + Factory 패턴)

```
1. lib/features/{feature}/ 디렉토리 생성

2. Domain Layer 설정
   - domain/entities/{entity}.dart 작성 (Domain Entity)
   - domain/repositories/{feature}_repository.dart 작성 (Repository 인터페이스)
   - domain/factories/repository_factory.dart 작성 (Factory 인터페이스)
   - domain/usecases/{action}_usecase.dart 작성 (Use Case)
   - domain/providers/repository_providers.dart 작성 (Factory Provider re-export)
   - domain/providers/usecase_providers.dart 작성 (UseCase Provider)

3. Data Layer 설정
   - data/datasources/supabase_{feature}_datasource.dart 작성
   - data/dtos/{entity}_dto.dart 작성 (필요시)
     - @JsonSerializable() 어노테이션 추가
     - flutter pub run build_runner build 실행
   - data/repositories/supabase_{feature}_repository.dart 작성
     - Repository 인터페이스 구현
     - DTO → Domain Entity 변환
   - data/factories/supabase_repository_factory.dart 작성 (Factory 구현체)
   - data/providers/factory_providers.dart 작성 (Factory Provider)
   - data/datasource_providers.dart 작성 (Datasource Provider)

4. Presentation Layer 설정
   - presentation/providers/providers.dart 작성 (통합 export)
   - presentation/providers/viewmodel_providers.dart 작성 (ViewModel Provider)
   - presentation/viewmodels/{feature}_{action}_viewmodel.dart 작성
     - Use Case만 사용 (Repository/Datasource 직접 사용 불가)
   - presentation/pages/{feature}_{action}_screen.dart 작성 (UI)

5. 라우팅 설정
   - lib/config/router.dart에 라우트 추가
```

**예시: 새 feature 추가 (Clean Architecture 구조)**
```
features/
└── {feature}/
    ├── domain/
    │   ├── entities/
    │   │   └── {entity}.dart
    │   ├── factories/
    │   │   └── repository_factory.dart
    │   ├── providers/
    │   │   ├── providers.dart
    │   │   ├── repository_providers.dart
    │   │   └── usecase_providers.dart
    │   ├── repositories/
    │   │   └── {feature}_repository.dart
    │   └── usecases/
    │       └── {action}_usecase.dart
    ├── data/
    │   ├── datasources/
    │   │   └── supabase_{feature}_datasource.dart
    │   ├── dtos/
    │   │   └── {entity}_dto.dart (필요시)
    │   ├── factories/
    │   │   └── supabase_repository_factory.dart
    │   ├── providers/
    │   │   └── factory_providers.dart
    │   ├── datasource_providers.dart
    │   └── repositories/
    │       └── supabase_{feature}_repository.dart
    └── presentation/
        ├── providers/
        │   ├── providers.dart
        │   └── viewmodel_providers.dart
        ├── viewmodels/
        │   └── {feature}_{action}_viewmodel.dart
        ├── pages/
        │   └── {feature}_{action}_screen.dart
        └── widgets/
            └── {widget}.dart
```

### 2. 데이터 모델 추가

**Domain Entity (순수 객체, JSON 직렬화 없음)**
```
1. lib/features/{feature}/domain/entities/{entity}.dart 작성
2. 순수한 Dart 클래스로 작성 (외부 의존성 없음)
3. 비즈니스 로직 포함 가능
```

**DTO 모델 (데이터 레이어)**
```
1. lib/features/{feature}/data/dtos/{entity}_dto.dart 작성
2. @JsonSerializable() 어노테이션 추가
3. flutter pub run build_runner build 실행
4. Repository에서 DTO → Domain Entity 변환 로직 구현 (toEntity() 메서드)
```

### 3. ViewModel 추가 (기존 피처에)

```
1. presentation/viewmodels/{feature}_{action}_viewmodel.dart 작성
   - Use Case만 사용 (Repository/Datasource 직접 사용 불가)
2. domain/usecases/{action}_usecase.dart 작성 (필요시)
3. domain/providers/usecase_providers.dart에 UseCase Provider 추가
4. presentation/providers/viewmodel_providers.dart에 ViewModel Provider 추가
5. presentation/pages/{feature}_{action}_screen.dart에서 사용
```

### 4. 데이터베이스 스키마 변경

```
1. docs/개발/데이터베이스/schema.sql 수정
2. Supabase SQL Editor에서 실행
```

---


